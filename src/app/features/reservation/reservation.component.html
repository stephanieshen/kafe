<div class="reservation">
  <div class="reservation__card-container">
    <p-card>
      @if (!isCompleted) {
        <app-header></app-header>
        <p-stepper [value]="1">
          <form [formGroup]="reservationForm">
            @for (stepItem of steps; track stepItem.title) {
              <p-step-item [value]="stepItem.step">
                <p-step>
                  <h3 class="reservation__step-title">{{ stepItem.title }}</h3>
                </p-step>
                <p-step-panel>
                  <ng-template #content let-activateCallback="activateCallback">

                    <ng-container [ngSwitch]="stepItem.step">
                      <app-step-date-time *ngSwitchCase="1" [form]="reservationForm"></app-step-date-time>
                      <app-step-size-and-preferences *ngSwitchCase="2" [form]="reservationForm"></app-step-size-and-preferences>
                      <app-step-region *ngSwitchCase="3" [form]="reservationForm"></app-step-region>
                      <app-step-contact *ngSwitchCase="4" [form]="reservationForm"></app-step-contact>
                      <app-step-review *ngSwitchCase="5" [formValue]="reservationForm.value"></app-step-review>
                    </ng-container>

                    <div class="flex py-10 gap-2">
                      @if (stepItem.step > 1) {
                        <p-button label="Back" severity="secondary" (onClick)="activateCallback(stepItem.step - 1)" />
                      }

                      @if (stepItem.step < steps.length) {
                        <p-button label="Next" (onClick)="activateCallback(stepItem.step + 1); handleNextStep(stepItem.step + 1)" />
                      }

                      @if (stepItem.step === steps.length) {
                        <p-button label="Book" (click)="submit()" />
                      }
                    </div>
                  </ng-template>
                </p-step-panel>
              </p-step-item>
            }
          </form>
        </p-stepper>
      } @else {
        <app-complete-reservation (clickedBookAnother)="bookAnother()"></app-complete-reservation>
      }
    </p-card>
  </div>
</div>